#!/bin/bash
echo "üöÄ –ù–∞—á–∏–Ω–∞—é –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ..."

# 1. –ü–µ—Ä–µ—Ö–æ–¥ –≤ –ø–∞–ø–∫—É
cd /var/www/lg110 || exit

# 2. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ
echo "üì• –°–∫–∞—á–∏–≤–∞—é —Å GitHub..."
git pull

# 3. –°–±–æ—Ä–∫–∞ –§—Ä–æ–Ω—Ç–∞
echo "üé® –°–æ–±–∏—Ä–∞—é –ê–¥–º–∏–Ω–∫—É..."
npm install
npm run build

# 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞
echo "üì¶ –ö–æ–ø–∏—Ä—É—é —Ñ–∞–π–ª—ã..."
mkdir -p server/public
cp -r dist/* server/public/

# 5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë—ç–∫–∞
echo "‚öôÔ∏è –û–±–Ω–æ–≤–ª—è—é –°–µ—Ä–≤–µ—Ä..."
cd server
npm install
npx prisma generate
npx prisma db push

# 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
echo "üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—é –±–æ—Ç–∞..."
pm2 restart lg110-bot

echo "‚úÖ –ì–û–¢–û–í–û! –ë–æ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω."
